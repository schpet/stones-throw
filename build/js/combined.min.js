function highlight(a,b,c){return c===undefined&&(c=!0),function(){$(".highlight").each(function(){$(this).removeClass("highlight")}),$("#"+a).addClass("highlight"),c&&$(window).scrollTop($("#"+a).offset().top),highlighted&&markers[highlighted].setIcon(icon),markers[a].setZIndex(zindex++),markers[a].setIcon(icon_highlight),highlighted=a,_gaq.push(["_trackEvent","stones throw","user",b])}}function searchTwitter(a){for(var b in markers)markers[b].setMap(null);markers={};var c="http://search.twitter.com/search.json";c+="?callback=?";var d=position.coords.latitude+","+position.coords.longitude+","+radius/1e3+"km";params={geocode:d,include_entities:!0,result_type:"recent",rpp:100},a&&(params.since_id=a),$.getJSON(c,params,function(a){var b=$("<ul class='unstyled' />"),c=$("<ul class='unstyled' />"),d=[];for(var e=0;e<a.results.length;e++){var f=a.results[e],g=new Date((f.created_at||"").replace(/-/g,"/").replace(/[TZ]/g," ")),h=((new Date).getTime()-g.getTime())/1e3,i=h>86400;if(i)continue;oldest_id=f.id_str;var j=prettyDate(f.created_at),k=twttr.txt.autoLink(f.text,{urlEntities:f.entities.urls,target:"_blank"}),l="https://twitter.com/"+f.from_user+"/status/"+f.id_str,m={text:k,handle:f.from_user,time:j,id:e,permalink:l,avatarSmall:f.profile_image_url.replace(/_normal\./,"_bigger."),avatarFull:f.profile_image_url.replace(/_normal\./,".")};if(f.geo){var n=f.geo.coordinates[0],o=f.geo.coordinates[1],p=new LatLon(n,o),q=userPosition.distanceTo(p);q=parseFloat(q).toFixed(2),m.distance=q,m.lat=n,m.lon=o,m.location=!0;var r=ich.tweet(m);b.append(r);var s=new google.maps.LatLng(n,o);d.push(s);var t=new google.maps.Marker({title:f.text,map:map,position:s,icon:icon});markers[e]=t,google.maps.event.addListener(t,"click",highlight(e,"map"))}else{var u=ich.tweet(m);c.append(u)}}$("#tweets").empty(),$("#tweets").append(b),$("#tweets-no-geo").empty(),$("#tweets-no-geo").append(c);var v=new google.maps.LatLngBounds;for(e=0;e<d.length;e++)v.extend(d[e]);map.fitBounds(v),$(".maplink").on("click",function(){try{window.scrollTo(0,$("#map").offset().top-20);var a=this;(function(){var b=$(a).attr("lat"),c=$(a).attr("lon"),d=new google.maps.LatLng(b,c);map.setCenter(d),map.setZoom(15),highlight($(a).attr("tweetid"),"button click",!1)()})()}catch(b){$("#error").text("erk something is borked :-("),console.log(b)}finally{return!1}}),$(".mute").on("click",function(){var a=this;return function(){var b=$(a).attr("handle"),c="."+b+"{ display: none }";$("<style type='text/css'>"+c+"</style>").appendTo("head")}(),_gaq.push(["_trackEvent","stones throw","user","mute"]),!1}),$(".avatar-link").on("click",function(){var a=$(this).attr("data-tweetid");(function(){$("#popup-"+a).modal()})()})})}function changeRadius(a){a?radius>=1e3?radius+=1e3:radius+=100:radius>1e3?radius-=1e3:radius>100&&(radius-=100),text="",radius>=1e3?text=parseInt(radius/1e3,10)+" km":text=radius+" m",$("#radius-feedback").text(text),searchTwitter()}function refresh(){searchTwitter(oldest_id)}function success(a){_gaq.push(["_trackEvent","stones throw","geolocation","success"]),position=a,$(".nogeo").hide(),$(".geo").show();var b=new google.maps.LatLng(position.coords.latitude,position.coords.longitude);userPosition=new LatLon(position.coords.latitude,position.coords.longitude);var c={zoom:13,center:b,mapTypeControl:!1,navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL},mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map($("#map").get(0),c);var d=new google.maps.Marker({position:b,map:map,title:"Your location, within "+position.coords.accuracy+" meters",zIndex:1e3});changeRadius(!1),_gaq.push(["_trackEvent","stones throw","geolocation","accuracy",position.coords.accuracy])}function error(a){_gaq.push(["_trackEvent","stones throw","geolocation","error",a])}function LatLon(a,b,c){typeof c=="undefined"&&(c=6371),this._lat=typeof a=="number"?a:typeof a=="string"&&a.trim()!=""?+a:NaN,this._lon=typeof b=="number"?b:typeof b=="string"&&b.trim()!=""?+b:NaN,this._radius=typeof c=="number"?c:typeof c=="string"&&trim(b)!=""?+c:NaN}function prettyDate(a){var b=new Date((a||"").replace(/-/g,"/").replace(/[TZ]/g," ")),c=((new Date).getTime()-b.getTime())/1e3,d=Math.floor(c/86400);if(isNaN(d)||d<0||d>=31)return;return d==0&&(c<60&&"just now"||c<120&&"1 minute ago"||c<3600&&Math.floor(c/60)+" minutes ago"||c<7200&&"1 hour ago"||c<86400&&Math.floor(c/3600)+" hours ago")||d==1&&"Yesterday"||d<7&&d+" days ago"||d<31&&Math.ceil(d/7)+" weeks ago"}(function(){var a=function(){function a(a){return(""+a).replace(/&(?!\w+;)|[<>"']/g,function(a){return g[a]||a})}var b=Object.prototype.toString;Array.isArray=Array.isArray||function(a){return"[object Array]"==b.call(a)};var c=String.prototype.trim,d;if(c)d=function(a){return null==a?"":c.call(a)};else{var e,f;/\S/.test(" ")?(e=/^[\s\xA0]+/,f=/[\s\xA0]+$/):(e=/^\s+/,f=/\s+$/),d=function(a){return null==a?"":a.toString().replace(e,"").replace(f,"")}}var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},h={},i=function(){};return i.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(a,b,c,d){d||(this.context=b,this.buffer=[]);if(this.includes("",a)){var a=this.render_pragmas(a),e=this.render_section(a,b,c);!1===e&&(e=this.render_tags(a,b,c,d));if(d)return e;this.sendLines(e)}else{if(d)return a;this.send(a)}},send:function(a){""!==a&&this.buffer.push(a)},sendLines:function(a){if(a)for(var a=a.split("\n"),b=0;b<a.length;b++)this.send(a[b])},render_pragmas:function(a){if(!this.includes("%",a))return a;var b=this,c=this.getCachedRegex("render_pragmas",function(a,b){return RegExp(a+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+b,"g")});return a.replace(c,function(a,c,d){if(!b.pragmas_implemented[c])throw{message:"This implementation of mustache doesn't understand the '"+c+"' pragma"};return b.pragmas[c]={},d&&(a=d.split("="),b.pragmas[c][a[0]]=a[1]),""})},render_partial:function(a,b,c){a=d(a);if(!c||void 0===c[a])throw{message:"unknown_partial '"+a+"'"};return!b||"object"!=typeof b[a]?this.render(c[a],b,c,!0):this.render(c[a],b[a],c,!0)},render_section:function(a,b,c){if(!this.includes("#",a)&&!this.includes("^",a))return!1;var d=this,e=this.getCachedRegex("render_section",function(a,b){return RegExp("^([\\s\\S]*?)"+a+"(\\^|\\#)\\s*(.+)\\s*"+b+"\n*([\\s\\S]*?)"+a+"\\/\\s*\\3\\s*"+b+"\\s*([\\s\\S]*)$","g")});return a.replace(e,function(a,e,f,g,h,i){var a=e?d.render_tags(e,b,c,!0):"",i=i?d.render(i,b,c,!0):"",j,g=d.find(g,b);return"^"===f?j=!g||Array.isArray(g)&&0===g.length?d.render(h,b,c,!0):"":"#"===f&&(j=Array.isArray(g)?d.map(g,function(a){return d.render(h,d.create_context(a),c,!0)}).join(""):d.is_object(g)?d.render(h,d.create_context(g),c,!0):"function"==typeof g?g.call(b,h,function(a){return d.render(a,b,c,!0)}):g?d.render(h,b,c,!0):""),a+j+i})},render_tags:function(b,c,d,e){for(var f=this,g=function(){return f.getCachedRegex("render_tags",function(a,b){return RegExp(a+"(=|!|>|&|\\{|%)?([^#\\^]+?)\\1?"+b+"+","g")})},h=g(),i=function(b,e,i){switch(e){case"!":return"";case"=":return f.set_delimiters(i),h=g(),"";case">":return f.render_partial(i,c,d);case"{":case"&":return f.find(i,c);default:return a(f.find(i,c))}},b=b.split("\n"),j=0;j<b.length;j++)b[j]=b[j].replace(h,i,this),e||this.send(b[j]);if(e)return b.join("\n")},set_delimiters:function(a){a=a.split(" "),this.otag=this.escape_regex(a[0]),this.ctag=this.escape_regex(a[1])},escape_regex:function(a){return arguments.callee.sRE||(arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g")),a.replace(arguments.callee.sRE,"\\$1")},find:function(a,b){function c(a){return!1===a||0===a||a}var a=d(a),e;if(a.match(/([a-z_]+)\./ig)){var f=this.walk_context(a,b);c(f)&&(e=f)}else c(b[a])?e=b[a]:c(this.context[a])&&(e=this.context[a]);return"function"==typeof e?e.apply(b):void 0!==e?e:""},walk_context:function(a,b){for(var c=a.split("."),d=void 0!=b[c[0]]?b:this.context,e=d[c.shift()];void 0!=e&&0<c.length;)d=e,e=e[c.shift()];return"function"==typeof e?e.apply(d):e},includes:function(a,b){return-1!=b.indexOf(this.otag+a)},create_context:function(a){if(this.is_object(a))return a;var b=".";this.pragmas["IMPLICIT-ITERATOR"]&&(b=this.pragmas["IMPLICIT-ITERATOR"].iterator);var c={};return c[b]=a,c},is_object:function(a){return a&&"object"==typeof a},map:function(a,b){if("function"==typeof a.map)return a.map(b);for(var c=[],d=a.length,e=0;e<d;e++)c.push(b(a[e]));return c},getCachedRegex:function(a,b){var c=h[this.otag];c||(c=h[this.otag]={});var d=c[this.ctag];return d||(d=c[this.ctag]={}),(c=d[a])||(c=d[a]=b(this.otag,this.ctag)),c}},{name:"mustache.js",version:"0.4.0",to_html:function(a,b,c,d){var e=new i;d&&(e.send=d),e.render(a,b||{},c);if(!d)return e.buffer.join("\n")}}}();(function(){var b={VERSION:"0.10",templates:{},$:"undefined"!=typeof window?window.jQuery||window.Zepto||null:null,addTemplate:function(d,e){if("object"==typeof d)for(var f in d)this.addTemplate(f,d[f]);else b[d]?console.error("Invalid name: "+d+"."):b.templates[d]?console.error('Template "'+d+'  " exists'):(b.templates[d]=e,b[d]=function(e,f){var e=e||{},g=a.to_html(b.templates[d],e,b.templates);return b.$&&!f?b.$(g):g})},clearAll:function(){for(var a in b.templates)delete b[a];b.templates={}},refresh:function(){b.clearAll(),b.grabTemplates()},grabTemplates:function(){var a,d=document.getElementsByTagName("script"),e,f=[];for(a=0,l=d.length;a<l;a++)(e=d[a])&&e.innerHTML&&e.id&&("text/html"===e.type||"text/x-icanhaz"===e.type)&&(b.addTemplate(e.id,"".trim?e.innerHTML.trim():e.innerHTML.replace(/^\s+/,"").replace(/\s+$/,"")),f.unshift(e));for(a=0,l=f.length;a<l;a++)f[a].parentNode.removeChild(f[a])}};"undefined"!=typeof require?module.exports=b:window.ich=b,"undefined"!=typeof document&&(b.$?b.$(function(){b.grabTemplates()}):document.addEventListener("DOMContentLoaded",function(){b.grabTemplates()},!0))})()})();var markers={},zindex=1e3,highlighted=null,icon=new google.maps.MarkerImage("img/tweet.png"),icon_highlight=new google.maps.MarkerImage("img/tweet_highlight.png"),map,position,userPosition,oldest_id=null,radius=600;navigator.geolocation?navigator.geolocation.getCurrentPosition(success,error):_gaq.push(["_trackEvent","stones throw","geolocation","not supported"]),$("#radius-increase").on("click",function(){changeRadius(!0)}),$("#radius-decrease").on("click",function(){changeRadius(!1)}),$("#refresh").on("click",function(){refresh()}),!function(a){function c(){var b=this,c=setTimeout(function(){b.$element.off(a.support.transition.end),d.call(b)},500);this.$element.one(a.support.transition.end,function(){clearTimeout(c),d.call(b)})}function d(a){this.$element.hide().trigger("hidden"),e.call(this)}function e(b){var c=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;this.$backdrop=a('<div class="modal-backdrop '+d+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(a.proxy(this.hide,this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),e?this.$backdrop.one(a.support.transition.end,b):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,a.proxy(f,this)):f.call(this)):b&&b()}function f(){this.$backdrop.remove(),this.$backdrop=null}function g(){var b=this;this.isShown&&this.options.keyboard?a(document).on("keyup.dismiss.modal",function(a){a.which==27&&b.hide()}):this.isShown||a(document).off("keyup.dismiss.modal")}"use strict";var b=function(b,c){this.options=c,this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this))};b.prototype={constructor:b,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var b=this,c=a.Event("show");this.$element.trigger(c);if(this.isShown||c.isDefaultPrevented())return;a("body").addClass("modal-open"),this.isShown=!0,g.call(this),e.call(this,function(){var c=a.support.transition&&b.$element.hasClass("fade");b.$element.parent().length||b.$element.appendTo(document.body),b.$element.show(),c&&b.$element[0].offsetWidth,b.$element.addClass("in"),c?b.$element.one(a.support.transition.end,function(){b.$element.trigger("shown")}):b.$element.trigger("shown")})},hide:function(b){b&&b.preventDefault();var e=this;b=a.Event("hide"),this.$element.trigger(b);if(!this.isShown||b.isDefaultPrevented())return;this.isShown=!1,a("body").removeClass("modal-open"),g.call(this),this.$element.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?c.call(this):d.call(this)}},a.fn.modal=function(c){return this.each(function(){var d=a(this),e=d.data("modal"),f=a.extend({},a.fn.modal.defaults,d.data(),typeof c=="object"&&c);e||d.data("modal",e=new b(this,f)),typeof c=="string"?e[c]():f.show&&e.show()})},a.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},a.fn.modal.Constructor=b,a(function(){a("body").on("click.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d,e=a(c.attr("data-target")||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({},e.data(),c.data());b.preventDefault(),e.modal(f)})})}(window.jQuery),LatLon.prototype.distanceTo=function(a,b){typeof b=="undefined"&&(b=4);var c=this._radius,d=this._lat.toRad(),e=this._lon.toRad(),f=a._lat.toRad(),g=a._lon.toRad(),h=f-d,i=g-e,j=Math.sin(h/2)*Math.sin(h/2)+Math.cos(d)*Math.cos(f)*Math.sin(i/2)*Math.sin(i/2),k=2*Math.atan2(Math.sqrt(j),Math.sqrt(1-j)),l=c*k;return l.toPrecisionFixed(b)},LatLon.prototype.bearingTo=function(a){var b=this._lat.toRad(),c=a._lat.toRad(),d=(a._lon-this._lon).toRad(),e=Math.sin(d)*Math.cos(c),f=Math.cos(b)*Math.sin(c)-Math.sin(b)*Math.cos(c)*Math.cos(d),g=Math.atan2(e,f);return(g.toDeg()+360)%360},LatLon.prototype.finalBearingTo=function(a){var b=a._lat.toRad(),c=this._lat.toRad(),d=(this._lon-a._lon).toRad(),e=Math.sin(d)*Math.cos(c),f=Math.cos(b)*Math.sin(c)-Math.sin(b)*Math.cos(c)*Math.cos(d),g=Math.atan2(e,f);return(g.toDeg()+180)%360},LatLon.prototype.midpointTo=function(a){lat1=this._lat.toRad(),lon1=this._lon.toRad(),lat2=a._lat.toRad();var b=(a._lon-this._lon).toRad(),c=Math.cos(lat2)*Math.cos(b),d=Math.cos(lat2)*Math.sin(b);return lat3=Math.atan2(Math.sin(lat1)+Math.sin(lat2),Math.sqrt((Math.cos(lat1)+c)*(Math.cos(lat1)+c)+d*d)),lon3=lon1+Math.atan2(d,Math.cos(lat1)+c),lon3=(lon3+3*Math.PI)%(2*Math.PI)-Math.PI,new LatLon(lat3.toDeg(),lon3.toDeg())},LatLon.prototype.destinationPoint=function(a,b){b=typeof b=="number"?b:typeof b=="string"&&b.trim()!=""?+b:NaN,b/=this._radius,a=a.toRad();var c=this._lat.toRad(),d=this._lon.toRad(),e=Math.asin(Math.sin(c)*Math.cos(b)+Math.cos(c)*Math.sin(b)*Math.cos(a)),f=d+Math.atan2(Math.sin(a)*Math.sin(b)*Math.cos(c),Math.cos(b)-Math.sin(c)*Math.sin(e));return f=(f+3*Math.PI)%(2*Math.PI)-Math.PI,new LatLon(e.toDeg(),f.toDeg())},LatLon.intersection=function(a,b,c,d){return b=typeof b=="number"?b:typeof b=="string"&&trim(b)!=""?+b:NaN,d=typeof d=="number"?d:typeof d=="string"&&trim(d)!=""?+d:NaN,lat1=a._lat.toRad(),lon1=a._lon.toRad(),lat2=c._lat.toRad(),lon2=c._lon.toRad(),brng13=b.toRad(),brng23=d.toRad(),dLat=lat2-lat1,dLon=lon2-lon1,dist12=2*Math.asin(Math.sqrt(Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(lat1)*Math.cos(lat2)*Math.sin(dLon/2)*Math.sin(dLon/2))),dist12==0?null:(brngA=Math.acos((Math.sin(lat2)-Math.sin(lat1)*Math.cos(dist12))/(Math.sin(dist12)*Math.cos(lat1))),isNaN(brngA)&&(brngA=0),brngB=Math.acos((Math.sin(lat1)-Math.sin(lat2)*Math.cos(dist12))/(Math.sin(dist12)*Math.cos(lat2))),Math.sin(lon2-lon1)>0?(brng12=brngA,brng21=2*Math.PI-brngB):(brng12=2*Math.PI-brngA,brng21=brngB),alpha1=(brng13-brng12+Math.PI)%(2*Math.PI)-Math.PI,alpha2=(brng21-brng23+Math.PI)%(2*Math.PI)-Math.PI,Math.sin(alpha1)==0&&Math.sin(alpha2)==0?null:Math.sin(alpha1)*Math.sin(alpha2)<0?null:(alpha3=Math.acos(-Math.cos(alpha1)*Math.cos(alpha2)+Math.sin(alpha1)*Math.sin(alpha2)*Math.cos(dist12)),dist13=Math.atan2(Math.sin(dist12)*Math.sin(alpha1)*Math.sin(alpha2),Math.cos(alpha2)+Math.cos(alpha1)*Math.cos(alpha3)),lat3=Math.asin(Math.sin(lat1)*Math.cos(dist13)+Math.cos(lat1)*Math.sin(dist13)*Math.cos(brng13)),dLon13=Math.atan2(Math.sin(brng13)*Math.sin(dist13)*Math.cos(lat1),Math.cos(dist13)-Math.sin(lat1)*Math.sin(lat3)),lon3=lon1+dLon13,lon3=(lon3+3*Math.PI)%(2*Math.PI)-Math.PI,new LatLon(lat3.toDeg(),lon3.toDeg())))},LatLon.prototype.rhumbDistanceTo=function(a){var b=this._radius,c=this._lat.toRad(),d=a._lat.toRad(),e=(a._lat-this._lat).toRad(),f=Math.abs(a._lon-this._lon).toRad(),g=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(c/2+Math.PI/4)),h=isNaN(e/g)?Math.cos(c):e/g;f>Math.PI&&(f=2*Math.PI-f);var i=Math.sqrt(e*e+h*h*f*f)*b;return i.toPrecisionFixed(4)},LatLon.prototype.rhumbBearingTo=function(a){var b=this._lat.toRad(),c=a._lat.toRad(),d=(a._lon-this._lon).toRad(),e=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(b/2+Math.PI/4));Math.abs(d)>Math.PI&&(d=d>0?-(2*Math.PI-d):2*Math.PI+d);var f=Math.atan2(d,e);return(f.toDeg()+360)%360},LatLon.prototype.rhumbDestinationPoint=function(a,b){var c=this._radius,d=parseFloat(b)/c,e=this._lat.toRad(),f=this._lon.toRad();a=a.toRad();var g=e+d*Math.cos(a),h=g-e,i=Math.log(Math.tan(g/2+Math.PI/4)/Math.tan(e/2+Math.PI/4)),j=isNaN(h/i)?Math.cos(e):h/i,k=d*Math.sin(a)/j;return Math.abs(g)>Math.PI/2&&(g=g>0?Math.PI-g:-(Math.PI-g)),lon2=(f+k+3*Math.PI)%(2*Math.PI)-Math.PI,new LatLon(g.toDeg(),lon2.toDeg())},LatLon.prototype.lat=function(a,b){return typeof a=="undefined"?this._lat:Geo.toLat(this._lat,a,b)},LatLon.prototype.lon=function(a,b){return typeof a=="undefined"?this._lon:Geo.toLon(this._lon,a,b)},LatLon.prototype.toString=function(a,b){return typeof a=="undefined"&&(a="dms"),isNaN(this._lat)||isNaN(this._lon)?"-,-":Geo.toLat(this._lat,a,b)+", "+Geo.toLon(this._lon,a,b)},typeof Number.prototype.toRad=="undefined"&&(Number.prototype.toRad=function(){return this*Math.PI/180}),typeof Number.prototype.toDeg=="undefined"&&(Number.prototype.toDeg=function(){return this*180/Math.PI}),typeof Number.prototype.toPrecisionFixed=="undefined"&&(Number.prototype.toPrecisionFixed=function(a){if(isNaN(this))return"NaN";var b=this<0?-this:this,c=this<0?"-":"";if(b==0){var d="0.";while(a--)d+="0";return d}var e=Math.ceil(Math.log(b)*Math.LOG10E),d=String(Math.round(b*Math.pow(10,a-e)));if(e>0){l=e-d.length;while(l-->0)d+="0";e<d.length&&(d=d.slice(0,e)+"."+d.slice(e))}else{while(e++<0)d="0"+d;d="0."+d}return c+d}),typeof String.prototype.trim=="undefined"&&(String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")}),typeof jQuery!="undefined"&&(jQuery.fn.prettyDate=function(){return this.each(function(){var a=prettyDate(this.title);a&&jQuery(this).text(a)})});if(typeof window=="undefined"||window===null)window={twttr:{}};window.twttr==null&&(window.twttr={});if(typeof twttr=="undefined"||twttr===null)twttr={};(function(){function b(a,b){return b=b||"",typeof a!="string"&&(a.global&&b.indexOf("g")<0&&(b+="g"),a.ignoreCase&&b.indexOf("i")<0&&(b+="i"),a.multiline&&b.indexOf("m")<0&&(b+="m"),a=a.source),new RegExp(a.replace(/#\{(\w+)\}/g,function(a,b){var c=twttr.txt.regexen[b]||"";return typeof c!="string"&&(c=c.source),c}),b)}function c(a,b){return a.replace(/#\{(\w+)\}/g,function(a,c){return b[c]||""})}function d(a,b,c){var d=String.fromCharCode(b);return c!==b&&(d+="-"+String.fromCharCode(c)),a.push(d),a}function q(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function u(a,b,c){return c?!a||a.match(b)&&RegExp["$&"]===a:typeof a=="string"&&a.match(b)&&RegExp["$&"]===a}twttr.txt={},twttr.txt.regexen={};var a={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};twttr.txt.htmlEscape=function(b){return b&&b.replace(/[&"'><]/g,function(b){return a[b]})};var e=String.fromCharCode,f=[e(32),e(133),e(160),e(5760),e(6158),e(8232),e(8233),e(8239),e(8287),e(12288)];d(f,9,13),d(f,8192,8202);var g=[e(65534),e(65279),e(65535)];d(g,8234,8238),twttr.txt.regexen.spaces_group=b(f.join("")),twttr.txt.regexen.spaces=b("["+f.join("")+"]"),twttr.txt.regexen.invalid_chars_group=b(g.join("")),twttr.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/;var h=[];d(h,1024,1279),d(h,1280,1319),d(h,11744,11775),d(h,42560,42655),d(h,1425,1471),d(h,1473,1474),d(h,1476,1477),d(h,1479,1479),d(h,1488,1514),d(h,1520,1524),d(h,64274,64296),d(h,64298,64310),d(h,64312,64316),d(h,64318,64318),d(h,64320,64321),d(h,64323,64324),d(h,64326,64335),d(h,1552,1562),d(h,1568,1631),d(h,1646,1747),d(h,1749,1756),d(h,1758,1768),d(h,1770,1775),d(h,1786,1788),d(h,1791,1791),d(h,1872,1919),d(h,2208,2208),d(h,2210,2220),d(h,2276,2302),d(h,64336,64433),d(h,64467,64829),d(h,64848,64911),d(h,64914,64967),d(h,65008,65019),d(h,65136,65140),d(h,65142,65276),d(h,8204,8204),d(h,3585,3642),d(h,3648,3662),d(h,4352,4607),d(h,12592,12677),d(h,43360,43391),d(h,44032,55215),d(h,55216,55295),d(h,65441,65500),d(h,12449,12538),d(h,12540,12542),d(h,65382,65439),d(h,65392,65392),d(h,65296,65305),d(h,65313,65338),d(h,65345,65370),d(h,12353,12438),d(h,12441,12446),d(h,13312,19903),d(h,19968,40959),d(h,173824,177983),d(h,177984,178207),d(h,194560,195103),d(h,12291,12291),d(h,12293,12293),d(h,12347,12347),twttr.txt.regexen.nonLatinHashtagChars=b(h.join(""));var i=[];d(i,192,214),d(i,216,246),d(i,248,255),d(i,256,591),d(i,595,596),d(i,598,599),d(i,601,601),d(i,603,603),d(i,611,611),d(i,616,616),d(i,623,623),d(i,626,626),d(i,649,649),d(i,651,651),d(i,699,699),d(i,7680,7935),twttr.txt.regexen.latinAccentChars=b(i.join("")),twttr.txt.regexen.hashSigns=/[#＃]/,twttr.txt.regexen.hashtagAlpha=b(/[a-z_#{latinAccentChars}#{nonLatinHashtagChars}]/i),twttr.txt.regexen.hashtagAlphaNumeric=b(/[a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}]/i),twttr.txt.regexen.endHashtagMatch=b(/^(?:#{hashSigns}|:\/\/)/),twttr.txt.regexen.hashtagBoundary=b(/(?:^|$|[^&a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}])/),twttr.txt.regexen.validHashtag=b(/(#{hashtagBoundary})(#{hashSigns})(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi),twttr.txt.regexen.validMentionPrecedingChars=/(?:^|[^a-zA-Z0-9_!#$%&*@＠]|RT:?)/,twttr.txt.regexen.atSigns=/[@＠]/,twttr.txt.regexen.validMentionOrList=b("(#{validMentionPrecedingChars})(#{atSigns})([a-zA-Z0-9_]{1,20})(/[a-zA-Z][a-zA-Z0-9_-]{0,24})?","g"),twttr.txt.regexen.validReply=b(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/),twttr.txt.regexen.endMentionMatch=b(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/),twttr.txt.regexen.validUrlPrecedingChars=b(/(?:[^A-Za-z0-9@＠$#＃#{invalid_chars_group}]|^)/),twttr.txt.regexen.invalidUrlWithoutProtocolPrecedingChars=/[-_.\/]$/,twttr.txt.regexen.invalidDomainChars=c("#{punct}#{spaces_group}#{invalid_chars_group}",twttr.txt.regexen),twttr.txt.regexen.validDomainChars=b(/[^#{invalidDomainChars}]/),twttr.txt.regexen.validSubdomain=b(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/),twttr.txt.regexen.validDomainName=b(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/),twttr.txt.regexen.validGTLD=b(/(?:(?:aero|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel|xxx)(?=[^0-9a-zA-Z]|$))/),twttr.txt.regexen.validCCTLD=b(/(?:(?:ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)(?=[^0-9a-zA-Z]|$))/),twttr.txt.regexen.validPunycode=b(/(?:xn--[0-9a-z]+)/),twttr.txt.regexen.validDomain=b(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/),twttr.txt.regexen.validAsciiDomain=b(/(?:(?:[a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi),twttr.txt.regexen.invalidShortDomain=b(/^#{validDomainName}#{validCCTLD}$/),twttr.txt.regexen.validPortNumber=b(/[0-9]+/),twttr.txt.regexen.validGeneralUrlPathChars=b(/[a-z0-9!\*';:=\+,\.\$\/%#\[\]\-_~|&#{latinAccentChars}]/i),twttr.txt.regexen.validUrlBalancedParens=b(/\(#{validGeneralUrlPathChars}+\)/i),twttr.txt.regexen.validUrlPathEndingChars=b(/[\+\-a-z0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i),twttr.txt.regexen.validUrlPath=b("(?:(?:#{validGeneralUrlPathChars}*(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*#{validUrlPathEndingChars})|(?:@#{validGeneralUrlPathChars}+/))","i"),twttr.txt.regexen.validUrlQueryChars=/[a-z0-9!?\*'\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i,twttr.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i,twttr.txt.regexen.extractUrl=b("((#{validUrlPrecedingChars})((https?:\\/\\/)?(#{validDomain})(?::(#{validPortNumber}))?(\\/#{validUrlPath}*)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi"),twttr.txt.regexen.validTcoUrl=/^https?:\/\/t\.co\/[a-z0-9]+/i,twttr.txt.regexen.validateUrlUnreserved=/[a-z0-9\-._~]/i,twttr.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i,twttr.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i,twttr.txt.regexen.validateUrlPchar=b("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|[:|@])","i"),twttr.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i,twttr.txt.regexen.validateUrlUserinfo=b("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*","i"),twttr.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i,twttr.txt.regexen.validateUrlIpv4=b(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i),twttr.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i,twttr.txt.regexen.validateUrlIp=b("(?:#{validateUrlIpv4}|#{validateUrlIpv6})","i"),twttr.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i,twttr.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i,twttr.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i,twttr.txt.regexen.validateUrlDomain=b(/(?:(?:#{validateUrlSubDomainSegment]}\.)*(?:#{validateUrlDomainSegment]}\.)#{validateUrlDomainTld})/i),twttr.txt.regexen.validateUrlHost=b("(?:#{validateUrlIp}|#{validateUrlDomain})","i"),twttr.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,twttr.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,twttr.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,twttr.txt.regexen.validateUrlUnicodeDomain=b(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i),twttr.txt.regexen.validateUrlUnicodeHost=b("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})","i"),twttr.txt.regexen.validateUrlPort=/[0-9]{1,5}/,twttr.txt.regexen.validateUrlUnicodeAuthority=b("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?","i"),twttr.txt.regexen.validateUrlAuthority=b("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?","i"),twttr.txt.regexen.validateUrlPath=b(/(\/#{validateUrlPchar}*)*/i),twttr.txt.regexen.validateUrlQuery=b(/(#{validateUrlPchar}|\/|\?)*/i),twttr.txt.regexen.validateUrlFragment=b(/(#{validateUrlPchar}|\/|\?)*/i),twttr.txt.regexen.validateUrlUnencoded=b("^(?:([^:/?#]+):\\/\\/)?([^/?#]*)([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$","i");var j="tweet-url",k="list-slug",l="username",m="hashtag",n=' rel="nofollow"',o={urlClass:!0,listClass:!0,usernameClass:!0,hashtagClass:!0,usernameUrlBase:!0,listUrlBase:!0,hashtagUrlBase:!0,usernameUrlBlock:!0,listUrlBlock:!0,hashtagUrlBlock:!0,linkUrlBlock:!0,usernameIncludeSymbol:!0,suppressLists:!0,suppressNoFollow:!0,suppressDataScreenName:!0,urlEntities:!0,before:!0},p={disabled:!0,readonly:!0,multiple:!0,checked:!0};twttr.txt.linkToHashtag=function(a,b,d){var e={hash:b.substring(a.indices[0],a.indices[0]+1),preText:"",text:twttr.txt.htmlEscape(a.hashtag),postText:"",extraHtml:d.suppressNoFollow?"":n};for(var f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);return c('#{before}<a href="#{hashtagUrlBase}#{text}" title="##{text}" class="#{urlClass} #{hashtagClass}"#{extraHtml}>#{hash}#{preText}#{text}#{postText}</a>',e)},twttr.txt.linkToMentionAndList=function(a,b,d){var e=b.substring(a.indices[0],a.indices[0]+1),f={at:d.usernameIncludeSymbol?"":e,at_before_user:d.usernameIncludeSymbol?e:"",user:twttr.txt.htmlEscape(a.screenName),slashListname:twttr.txt.htmlEscape(a.listSlug),extraHtml:d.suppressNoFollow?"":n,preChunk:"",postChunk:""};for(var g in d)d.hasOwnProperty(g)&&(f[g]=d[g]);if(a.listSlug&&!d.suppressLists){var h=f.chunk=c("#{user}#{slashListname}",f);return f.list=twttr.txt.htmlEscape(h.toLowerCase()),c('#{before}#{at}<a class="#{urlClass} #{listClass}" href="#{listUrlBase}#{list}"#{extraHtml}>#{preChunk}#{at_before_user}#{chunk}#{postChunk}</a>',f)}return f.chunk=f.user,f.dataScreenName=d.suppressDataScreenName?"":c('data-screen-name="#{chunk}" ',f),c('#{before}#{at}<a class="#{urlClass} #{usernameClass}" #{dataScreenName}href="#{usernameUrlBase}#{chunk}"#{extraHtml}>#{preChunk}#{at_before_user}#{chunk}#{postChunk}</a>',f)},twttr.txt.linkToUrl=function(a,b,d){var e=a.url,f=e,g=twttr.txt.htmlEscape(f);if(d.urlEntities&&d.urlEntities[e]&&d.urlEntities[e].display_url){var f=d.urlEntities[e].display_url,h=d.urlEntities[e].expanded_url;d.title||(d.title=h);var i=f.replace(/…/g,"");if(h.indexOf(i)!=-1){var j=h.indexOf(i),k={displayUrlSansEllipses:i,beforeDisplayUrl:h.substr(0,j),afterDisplayUrl:h.substr(j+i.length),precedingEllipsis:f.match(/^…/)?"…":"",followingEllipsis:f.match(/…$/)?"…":""};$.each(k,function(a,b){k[a]=twttr.txt.htmlEscape(b)}),k.invisible=d.invisibleTagAttrs,g=c("<span class='tco-ellipsis'>#{precedingEllipsis}<span #{invisible}>&nbsp;</span></span><span #{invisible}>#{beforeDisplayUrl}</span><span class='js-display-url'>#{displayUrlSansEllipses}</span><span #{invisible}>#{afterDisplayUrl}</span><span class='tco-ellipsis'><span #{invisible}>&nbsp;</span>#{followingEllipsis}</span>",k)}else g=f}var l={htmlAttrs:d.htmlAttrs,url:twttr.txt.htmlEscape(e),linkText:g};return c('<a href="#{url}"#{htmlAttrs}>#{linkText}</a>',l)},twttr.txt.autoLinkEntities=function(a,b,c){c=q(c||{}),c.suppressNoFollow||(c.rel="nofollow"),c.urlClass&&(c["class"]=c.urlClass),c.urlClass=c.urlClass||j,c.hashtagClass=c.hashtagClass||m,c.hashtagUrlBase=c.hashtagUrlBase||"https://twitter.com/#!/search?q=%23",c.listClass=c.listClass||k,c.usernameClass=c.usernameClass||l,c.usernameUrlBase=c.usernameUrlBase||"https://twitter.com/",c.listUrlBase=c.listUrlBase||"https://twitter.com/",c.before=c.before||"",c.htmlAttrs=twttr.txt.extractHtmlAttrsFromOptions(c),c.invisibleTagAttrs=c.invisibleTagAttrs||"style='position:absolute;left:-9999px;'";var d,e,f;if(c.urlEntities){d={};for(e=0,f=c.urlEntities.length;e<f;e++)d[c.urlEntities[e].url]=c.urlEntities[e];c.urlEntities=d}var g="",h=0;for(var e=0;e<b.length;e++){var i=b[e];g+=a.substring(h,i.indices[0]),i.url?g+=twttr.txt.linkToUrl(i,a,c):i.hashtag?g+=twttr.txt.linkToHashtag(i,a,c):i.screenName&&(g+=twttr.txt.linkToMentionAndList(i,a,c)),h=i.indices[1]}return g+=a.substring(h,a.length),g},twttr.txt.extractHtmlAttrsFromOptions=function(a){var b="";for(var d in a){var e=a[d];if(o[d])continue;p[d]&&(e=e?d:null);if(e==null)continue;b+=c(' #{k}="#{v}" ',{k:twttr.txt.htmlEscape(d),v:twttr.txt.htmlEscape(e.toString())})}return b},twttr.txt.autoLink=function(a,b){var c=twttr.txt.extractEntitiesWithIndices(a,{extractUrlWithoutProtocol:!1});return twttr.txt.autoLinkEntities(a,c,b)},twttr.txt.autoLinkUsernamesOrLists=function(a,b){var c=twttr.txt.extractMentionsOrListsWithIndices(a);return twttr.txt.autoLinkEntities(a,c,b)},twttr.txt.autoLinkHashtags=function(a,b){var c=twttr.txt.extractHashtagsWithIndices(a);return twttr.txt.autoLinkEntities(a,c,b)},twttr.txt.autoLinkUrlsCustom=function(a,b){var c=twttr.txt.extractUrlsWithIndices(a,{extractUrlWithoutProtocol:!1});return twttr.txt.autoLinkEntities(a,c,b)},twttr.txt.removeOverlappingEntities=function(a){a.sort(function(a,b){return a.indices[0]-b.indices[0]});var b=a[0];for(var c=1;c<a.length;c++)b.indices[1]>a[c].indices[0]?(a.splice(
c,1),c--):b=a[c]},twttr.txt.extractEntitiesWithIndices=function(a,b){var c=twttr.txt.extractUrlsWithIndices(a,b).concat(twttr.txt.extractMentionsOrListsWithIndices(a)).concat(twttr.txt.extractHashtagsWithIndices(a,{checkUrlOverlap:!1}));return c.length==0?[]:(twttr.txt.removeOverlappingEntities(c),c)},twttr.txt.extractMentions=function(a){var b=[],c=twttr.txt.extractMentionsWithIndices(a);for(var d=0;d<c.length;d++){var e=c[d].screenName;b.push(e)}return b},twttr.txt.extractMentionsWithIndices=function(a){var b=[],c=twttr.txt.extractMentionsOrListsWithIndices(a);for(var d=0;d<c.length;d++)mentionOrList=c[d],mentionOrList.listSlug==""&&b.push({screenName:mentionOrList.screenName,indices:mentionOrList.indices});return b},twttr.txt.extractMentionsOrListsWithIndices=function(a){if(!a||!a.match(twttr.txt.regexen.atSigns))return[];var b=[],c=0;return a.replace(twttr.txt.regexen.validMentionOrList,function(d,e,f,g,h,i,j){var k=j.slice(i+d.length);if(!k.match(twttr.txt.regexen.endMentionMatch)){h=h||"";var l=a.indexOf(f+g+h,c);c=l+g.length+h.length+1,b.push({screenName:g,listSlug:h,indices:[l,c]})}}),b},twttr.txt.extractReplies=function(a){if(!a)return null;var b=a.match(twttr.txt.regexen.validReply);return!b||RegExp.rightContext.match(twttr.txt.regexen.endMentionMatch)?null:b[1]},twttr.txt.extractUrls=function(a,b){var c=[],d=twttr.txt.extractUrlsWithIndices(a,b);for(var e=0;e<d.length;e++)c.push(d[e].url);return c},twttr.txt.extractUrlsWithIndices=function(a,b){b||(b={extractUrlsWithoutProtocol:!0});if(!a||(b.extractUrlsWithoutProtocol?!a.match(/\./):!a.match(/:/)))return[];var c=[];while(twttr.txt.regexen.extractUrl.exec(a)){var d=RegExp.$2,e=RegExp.$3,f=RegExp.$4,g=RegExp.$5,h=RegExp.$7,i=twttr.txt.regexen.extractUrl.lastIndex,j=i-e.length;if(!f){if(!b.extractUrlsWithoutProtocol||d.match(twttr.txt.regexen.invalidUrlWithoutProtocolPrecedingChars))continue;var k=null,l=!1,m=0;g.replace(twttr.txt.regexen.validAsciiDomain,function(a){var b=g.indexOf(a,m);m=b+a.length,k={url:a,indices:[j+b,j+m]},l=a.match(twttr.txt.regexen.invalidShortDomain),l||c.push(k)});if(k==null)continue;h&&(l&&c.push(k),k.url=e.replace(g,k.url),k.indices[1]=i)}else e.match(twttr.txt.regexen.validTcoUrl)&&(e=RegExp.lastMatch,i=j+e.length),c.push({url:e,indices:[j,i]})}return c},twttr.txt.extractHashtags=function(a){var b=[],c=twttr.txt.extractHashtagsWithIndices(a);for(var d=0;d<c.length;d++)b.push(c[d].hashtag);return b},twttr.txt.extractHashtagsWithIndices=function(a,b){b||(b={checkUrlOverlap:!0});if(!a||!a.match(twttr.txt.regexen.hashSigns))return[];var c=[],d=0;a.replace(twttr.txt.regexen.validHashtag,function(b,e,f,g,h,i){var j=i.slice(h+b.length);if(j.match(twttr.txt.regexen.endHashtagMatch))return;var k=a.indexOf(f+g,d);d=k+g.length+1,c.push({hashtag:g,indices:[k,d]})});if(b.checkUrlOverlap){var e=twttr.txt.extractUrlsWithIndices(a);if(e.length>0){var f=c.concat(e);twttr.txt.removeOverlappingEntities(f),c=[];for(var g=0;g<f.length;g++)f[g].hashtag&&c.push(f[g])}}return c},twttr.txt.modifyIndicesFromUnicodeToUTF16=function(a,b){twttr.txt.convertUnicodeIndices(a,b,!1)},twttr.txt.modifyIndicesFromUTF16ToUnicode=function(a,b){twttr.txt.convertUnicodeIndices(a,b,!0)},twttr.txt.convertUnicodeIndices=function(a,b,c){if(b.length==0)return;var d=0,e=0;b.sort(function(a,b){return a.indices[0]-b.indices[0]});var f=0,g=b[0];while(d<a.length){if(g.indices[0]==(c?d:e)){var h=g.indices[1]-g.indices[0];g.indices[0]=c?e:d,g.indices[1]=g.indices[0]+h,f++;if(f==b.length)break;g=b[f]}var i=a.charCodeAt(d);55296<=i&&i<=56319&&d<a.length-1&&(i=a.charCodeAt(d+1),56320<=i&&i<=57343&&d++),e++,d++}},twttr.txt.splitTags=function(a){var b=a.split("<"),c,d=[],e;for(var f=0;f<b.length;f+=1){e=b[f];if(!e)d.push("");else{c=e.split(">");for(var g=0;g<c.length;g+=1)d.push(c[g])}}return d},twttr.txt.hitHighlight=function(a,b,c){var d="em";b=b||[],c=c||{};if(b.length===0)return a;var e=c.tag||d,f=["<"+e+">","</"+e+">"],g=twttr.txt.splitTags(a),h,i,j="",k=0,l=g[0],m=0,n=0,o=!1,p=l,q=[],r,s,t,u,v;for(h=0;h<b.length;h+=1)for(i=0;i<b[h].length;i+=1)q.push(b[h][i]);for(r=0;r<q.length;r+=1){s=q[r],t=f[r%2],u=!1;while(l!=null&&s>=m+l.length)j+=p.slice(n),o&&s===m+p.length&&(j+=t,u=!0),g[k+1]&&(j+="<"+g[k+1]+">"),m+=p.length,n=0,k+=2,l=g[k],p=l,o=!1;!u&&l!=null?(v=s-m,j+=p.slice(n,v)+t,n=v,r%2===0?o=!0:o=!1):u||(u=!0,j+=t)}if(l!=null){n<p.length&&(j+=p.slice(n));for(r=k+1;r<g.length;r+=1)j+=r%2===0?g[r]:"<"+g[r]+">"}return j};var r=140,s=[e(65534),e(65279),e(65535),e(8234),e(8235),e(8236),e(8237),e(8238)];twttr.txt.isInvalidTweet=function(a){if(!a)return"empty";if(a.length>r)return"too_long";for(var b=0;b<s.length;b++)if(a.indexOf(s[b])>=0)return"invalid_characters";return!1},twttr.txt.isValidTweetText=function(a){return!twttr.txt.isInvalidTweet(a)},twttr.txt.isValidUsername=function(a){if(!a)return!1;var b=twttr.txt.extractMentions(a);return b.length===1&&b[0]===a.slice(1)};var t=b(/^#{validMentionOrList}$/);twttr.txt.isValidList=function(a){var b=a.match(t);return!!b&&b[1]==""&&!!b[4]},twttr.txt.isValidHashtag=function(a){if(!a)return!1;var b=twttr.txt.extractHashtags(a);return b.length===1&&b[0]===a.slice(1)},twttr.txt.isValidUrl=function(a,b,c){b==null&&(b=!0),c==null&&(c=!0);if(!a)return!1;var d=a.match(twttr.txt.regexen.validateUrlUnencoded);if(!d||d[0]!==a)return!1;var e=d[1],f=d[2],g=d[3],h=d[4],i=d[5];return(!c||u(e,twttr.txt.regexen.validateUrlScheme)&&e.match(/^https?$/i))&&u(g,twttr.txt.regexen.validateUrlPath)&&u(h,twttr.txt.regexen.validateUrlQuery,!0)&&u(i,twttr.txt.regexen.validateUrlFragment,!0)?b&&u(f,twttr.txt.regexen.validateUrlUnicodeAuthority)||!b&&u(f,twttr.txt.regexen.validateUrlAuthority):!1},typeof module!="undefined"&&module.exports&&(module.exports=twttr.txt)})();